<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>í•œì ë§ˆìŠ¤í„° ğŸ®</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ğŸ®</text></svg>">
    
    <link href="https://fonts.googleapis.com/css2?family=Nanum+Gothic:wght@400;700&family=Nanum+Pen+Script&display=swap" rel="stylesheet">
    
    <style>
        :root {
            --bg-color: #fdf6f0;
            --card-bg: #ffffff;
            --primary: #ffb7b2; /* í•œì í…Œë§ˆì— ë§ì¶° ì‚´ì§ ë”°ëœ»í•œ í†¤ìœ¼ë¡œ */
            --secondary: #c1e1c1;
            --accent: #ff9aa2;
            --text-color: #5d5d5d;
            --btn-bg: #f8f9fa;
        }

        body { 
            font-family: 'Nanum Gothic', sans-serif; 
            background-color: var(--bg-color); 
            color: var(--text-color);
            display: flex; flex-direction: column; align-items: center; 
            margin: 0; padding: 20px; 
            min-height: 100vh;
            touch-action: manipulation;
        }

        .app-icon { font-size: 40px; margin-bottom: 5px; display: block; }

        #game-container { 
            background: var(--card-bg); 
            padding: 25px; border-radius: 35px; 
            box-shadow: 0 15px 35px rgba(0,0,0,0.03); 
            width: 100%; max-width: 450px; text-align: center;
            border: 6px solid #fff;
            box-sizing: border-box;
            position: relative;
        }

        .mode-badge {
            display: inline-block; padding: 6px 18px; border-radius: 50px;
            font-size: 13px; font-weight: bold; margin-bottom: 15px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
        }
        .mode-normal { background: var(--primary); color: white; }
        .mode-review { background: var(--accent); color: white; }

        .setup-section { margin-bottom: 15px; font-size: 14px; color: #bbb; display: flex; justify-content: center; align-items: center; gap: 8px; }
        select { 
            padding: 6px 12px; border-radius: 12px; border: 1.5px solid #f0f0f0; 
            font-family: 'Nanum Gothic', sans-serif; color: #888; outline: none; background: #fff;
        }

        #word-display { 
            font-family: 'serif'; /* í•œìëŠ” ì„¸ë¦¬í”„ì²´ê°€ ë” ë©‹ìŠ¤ëŸ¬ì›Œìš” */
            font-size: 100px; 
            font-weight: bold; margin: 15px 0; 
            color: #333; text-shadow: 2px 2px 0px #f8f8f8;
            min-height: 120px; line-height: 1.1;
            display: flex; align-items: center; justify-content: center;
        }

        .options-grid { display: grid; gap: 14px; margin-top: 10px; }
        
        button { 
            font-family: 'Nanum Gothic', sans-serif;
            padding: 18px; font-size: 18px; cursor: pointer; 
            border: none; border-radius: 22px; 
            background: var(--btn-bg); color: var(--text-color);
            transition: all 0.2s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 5px 0px #eee;
            line-height: 1.4;
        }

        button:hover:not(:disabled) { background: #fff; transform: translateY(-3px); box-shadow: 0 8px 0px #eee; }
        button:active:not(:disabled) { transform: translateY(2px); box-shadow: none; }
        button:disabled { opacity: 0.7; cursor: default; }

        #score-display { 
            margin-top: 25px; font-size: 13px; color: #bbb;
            background: #fafafa; padding: 15px; border-radius: 20px;
            display: flex; justify-content: space-around;
        }

        .feedback { font-weight: bold; margin: 15px 0; height: 35px; font-size: 20px; display: flex; align-items: center; justify-content: center; gap: 5px; }
        .correct { color: #a2d2ff; }
        .incorrect { color: #ffafcc; }

        .result-screen { display: none; padding: 20px 0; }
        .btn-action { color: white; font-weight: bold; margin-top: 15px; width: 100%; font-size: 19px; border: none; cursor: pointer; }
        .btn-blue { background: var(--primary); box-shadow: 0 5px 0px #e5a19d; border-radius: 22px; padding: 20px; }
        .btn-orange { background: #ffcc5c; box-shadow: 0 5px 0px #e5b752; border-radius: 22px; padding: 20px; }
        .hidden { display: none; }
    </style>
</head>
<body>

    <span class="app-icon">ğŸ®</span>
    
    <div id="game-container">
        <div id="quiz-screen">
            <div id="mode-indicator" class="mode-badge mode-normal">í•œì í•™ìŠµ ëª¨ë“œ</div>
            <div class="setup-section">
                <span>âš™ï¸ ë³´ê¸° ì„¤ì •:</span>
                <select id="option-count" onchange="restartOnOptionChange()">
                    <option value="2">2ì§€ ì„ ë‹¤</option>
                    <option value="3">3ì§€ ì„ ë‹¤</option>
                    <option value="4" selected>4ì§€ ì„ ë‹¤</option>
                </select>
            </div>

            <div id="word-display">...</div>
            <div id="options" class="options-grid"></div>
            <div id="feedback" class="feedback"></div>
            
            <div id="score-display">
                <span>ğŸ“ <span id="current-q-num">1</span>/10</span>
                <span>â­ <span id="correct-q-num">0</span></span>
            </div>
        </div>

        <div id="result-screen" class="result-screen">
            <span id="res-icon" style="font-size: 60px; display: block; margin-bottom: 10px;">ğŸ‰</span>
            <h2 id="result-title">í›Œë¥­í•´ìš”!</h2>
            <p id="result-stats" style="font-size: 22px; color: #777; margin: 10px 0;"></p>
            <p id="result-msg" style="font-size: 16px; color: #aaa; margin-bottom: 25px; line-height: 1.5;"></p>
            <button onclick="startGame()" class="btn-action btn-blue">âœ¨ ìƒˆë¡œìš´ 10ë¬¸ì œ</button>
            <button id="retry-failed-btn" onclick="startRetryMode()" class="btn-action btn-orange">ğŸ” í‹€ë¦° ë¬¸ì œ ë³µìŠµí•˜ê¸°</button>
        </div>
    </div>

<script>
    // ì§€í˜œë‹˜ì„ ìœ„í•œ ìƒìš© í•œì ë°ì´í„°ì…‹ (í•œì, íˆë¼ê°€ë‚˜, í•œê¸€ë°œìŒ, ëœ»)
    const kanjiData = [
        {k: "æ°´", h: "ã¿ãš", p: "ë¯¸ì¦ˆ", m: "ë¬¼"},
        {k: "äºº", h: "ã²ã¨", p: "íˆí† ", m: "ì‚¬ëŒ"},
        {k: "å±±", h: "ã‚„ã¾", p: "ì•¼ë§ˆ", m: "ì‚°"},
        {k: "æ—¥", h: "ã²", p: "íˆ", m: "í•´/ë‚ "},
        {k: "å£", h: "ãã¡", p: "ì¿ ì¹˜", m: "ì…"},
        {k: "æœ¨", h: "ã", p: "í‚¤", m: "ë‚˜ë¬´"},
        {k: "è»Š", h: "ãã‚‹ã¾", p: "ì¿ ë£¨ë§ˆ", m: "ìë™ì°¨"},
        {k: "ç©º", h: "ãã‚‰", p: "ì†Œë¼", m: "í•˜ëŠ˜"},
        {k: "æ‰‹", h: "ã¦", p: "í…Œ", m: "ì†"},
        {k: "å­", h: "ã“", p: "ì½”", m: "ì•„ì´"},
        {k: "æœˆ", h: "ã¤ã", p: "ì¸ í‚¤", m: "ë‹¬"},
        {k: "ç«", h: "ã²", p: "íˆ", m: "ë¶ˆ"},
        {k: "åœŸ", h: "ã¤ã¡", p: "ì¸ ì¹˜", m: "í™"},
        {k: "é‡‘", h: "ã‹ã­", p: "ì¹´ë„¤", m: "ëˆ/ê¸ˆ"},
        {k: "å¥³", h: "ãŠã‚“ãª", p: "ì˜¨ë‚˜", m: "ì—¬ì"},
        {k: "ç”·", h: "ãŠã¨ã“", p: "ì˜¤í† ì½”", m: "ë‚¨ì"},
        {k: "ç›®", h: "ã‚", p: "ë©”", m: "ëˆˆ"},
        {k: "è€³", h: "ã¿ã¿", p: "ë¯¸ë¯¸", m: "ê·€"},
        {k: "è¶³", h: "ã‚ã—", p: "ì•„ì‹œ", m: "ë°œ"},
        {k: "èŠ±", h: "ã¯ãª", p: "í•˜ë‚˜", m: "ê½ƒ"},
        {k: "å·", h: "ã‹ã‚", p: "ì¹´ì™€", m: "ê°•"},
        {k: "çŸ³", h: "ã„ã—", p: "ì´ì‹œ", m: "ëŒ"},
        {k: "å¤©", h: "ã¦ã‚“", p: "í…", m: "í•˜ëŠ˜(ì²œ)"},
        {k: "æ°—", h: "ã", p: "í‚¤", m: "ê¸°ìš´"},
        {k: "é›¨", h: "ã‚ã‚", p: "ì•„ë©”", m: "ë¹„"},
        {k: "ä¸‹", h: "ã—ãŸ", p: "ì‹œíƒ€", m: "ì•„ë˜"},
        {k: "ä¸Š", h: "ã†ãˆ", p: "ìš°ì—", m: "ìœ„"},
        {k: "å³", h: "ã¿ã", p: "ë¯¸ê¸°", m: "ì˜¤ë¥¸ìª½"},
        {k: "å·¦", h: "ã²ã ã‚Š", p: "íˆë‹¤ë¦¬", m: "ì™¼ìª½"},
        {k: "å", h: "ãª", p: "ë‚˜", m: "ì´ë¦„"}
    ];

    let currentQuizSet = [], currentIdx = 0, correctCount = 0, failedQuestions = [], isReviewMode = false;

    function restartOnOptionChange() {
        renderQuestion();
    }

    function startGame() {
        isReviewMode = false; failedQuestions = [];
        currentQuizSet = [...kanjiData].sort(() => Math.random() - 0.5).slice(0, 10);
        resetState();
    }

    function startRetryMode() {
        isReviewMode = true;
        currentQuizSet = [...failedQuestions].sort(() => Math.random() - 0.5);
        failedQuestions = []; 
        resetState();
    }

    function resetState() {
        currentIdx = 0; correctCount = 0;
        const indicator = document.getElementById('mode-indicator');
        indicator.innerText = isReviewMode ? "í•œì ë³µìŠµ ëª¨ë“œ ğŸ”" : "í•œì ê¸°ë³¸ ëª¨ë“œ âœ¨";
        indicator.className = "mode-badge " + (isReviewMode ? "mode-review" : "mode-normal");
        document.getElementById('quiz-screen').style.display = 'block';
        document.getElementById('result-screen').style.display = 'none';
        renderQuestion();
    }

    function renderQuestion() {
        if (currentIdx >= currentQuizSet.length) { showResult(); return; }
        
        const q = currentQuizSet[currentIdx];
        const numOptions = parseInt(document.getElementById('option-count').value);
        
        document.getElementById('word-display').innerText = q.k;
        document.getElementById('feedback').innerText = "";
        document.getElementById('current-q-num').innerText = currentIdx + 1;
        document.getElementById('correct-q-num').innerText = correctCount;

        // ë³´ê¸° í˜•ì‹: ë°œìŒ(íˆë¼ê°€ë‚˜) - í•œê¸€ë°œìŒ - ëœ»
        const getLabel = (item) => `${item.p} (${item.h}) - ${item.m}`;
        
        let correctLabel = getLabel(q);
        let options = [correctLabel];
        let others = kanjiData.filter(item => item.k !== q.k).sort(() => Math.random() - 0.5);
        
        for(let i=0; i < numOptions - 1; i++) {
            if(others[i]) options.push(getLabel(others[i]));
        }
        options.sort(() => Math.random() - 0.5);

        const optionsDiv = document.getElementById('options');
        optionsDiv.innerHTML = "";
        options.forEach(opt => {
            const btn = document.createElement('button');
            btn.innerText = opt;
            btn.onclick = () => checkAnswer(opt, correctLabel, q);
            optionsDiv.appendChild(btn);
        });
    }

    function checkAnswer(selected, correct, qObj) {
        const allBtns = document.querySelectorAll('#options button');
        allBtns.forEach(b => b.disabled = true);
        
        const feedback = document.getElementById('feedback');
        if (selected === correct) {
            feedback.innerHTML = "<span>ğŸŒ¸ ì •ë‹µì…ë‹ˆë‹¤!</span>";
            feedback.className = "feedback correct";
            correctCount++;
        } else {
            feedback.innerHTML = `<span>âŒ ì •ë‹µ: ${correct}</span>`;
            feedback.className = "feedback incorrect";
            if (!failedQuestions.includes(qObj)) failedQuestions.push(qObj);
        }
        
        currentIdx++; 
        setTimeout(renderQuestion, 1200);
    }

    function showResult() {
        document.getElementById('quiz-screen').style.display = 'none';
        document.getElementById('result-screen').style.display = 'block';
        
        const stats = document.getElementById('result-stats');
        const msg = document.getElementById('result-msg');
        const retryBtn = document.getElementById('retry-failed-btn');

        stats.innerText = `${currentQuizSet.length}ë¬¸ì œ ì¤‘ ${correctCount}ê°œ ì„±ê³µ!`;
        
        if (failedQuestions.length > 0) {
            msg.innerText = `í•œìëŠ” ë°˜ë³µì´ ì¤‘ìš”í•´ìš”!\ní‹€ë¦° ${failedQuestions.length}ë¬¸ì œë¥¼ ë‹¤ì‹œ ì‚´í´ë³¼ê¹Œìš”?`;
            retryBtn.classList.remove('hidden');
            retryBtn.innerText = `ğŸ” í‹€ë¦° ${failedQuestions.length}ë¬¸ì œ ë³µìŠµí•˜ê¸°`;
        } else {
            msg.innerText = "ì™€ìš°! ì¼ë³¸ì–´ í•œì ì‹¤ë ¥ì´ ëŒ€ë‹¨í•˜ì‹ ë°ìš”?\nì´ëŒ€ë¡œë§Œ ì­‰ì­‰ ë‚˜ì•„ê°€ìš”!";
            retryBtn.classList.add('hidden');
        }
    }

    window.onload = startGame;
</script>
</body>
</html>